### 클라우드 서비스?
필요한 IT자원을 즉시 사용할 수 있는 환경을 제공하는 서비스이다.   
보통, 기업 내에서만 사용하는 사설(private) 클라우드와 여러 기업의 사용자가 함께 사용하는 공용(public) 클라우드로 나뉜다.   
일정 규모로 리소스가 활용될 것이라 충분히 예측되는 상황에선 사설 클라우드가 비용적으로 유리하지만, 그렇지 않은 경우엔 사용량에 따라 부과되는 공용 클라우드가 유리하다.   

### SaaS, Paas, IaaS
클라우드 환경의 '판매 상품' 관점에서 분리되는 용어들이다.   
SaaS는 기업의 개인용 이메일 서비스와 같이 최종 사용자가 직접 사용하는 애플리케이션 환경을 클라우드 형태로 서비스하는 것을 말한다.   
PaaS는 애플리케이션의 개발 또는 운영에 필요한 서버, 데이터베이스, 개발 프레임워크, 컴파일러 등의 환경을 클라우드 형태로 제공한다.   
IaaS는 가상화된 환경에서 서버, 네트워크, 스토리지 등의 IT인프라 자원을 제공한다.   
대표적인 예시로 SaaS는 Google Drive, PaaS는 Google App Engine, IaaS는 AWS 가 있다.

### IaaS형 클라우드의 장점
과거에는 서버를 구축하기 위한 준비과정이 꽤나 복잡하고 귀찮았다. 장비 사양 결정을 위한 비교/분석, 비용 측정, 서버 설치, 배선 작업 등등 시간도 오래 걸렸다.   
IaaS는 이러한 준비과정을 단축시키고, 실제 물리적 장비 간 차이를 인식하지 않고도 시스템을 구축할 수 있게 해준다.   
또한, 같은 환경을 다시 생성하기 위한 과정을 구성 관리 툴(chef나 puppet)로 자동화 할 수 있다. 기존에도 가능은 했으나 서버 설치나 네트워크 연결은 어려웠는데 클라우드 환경으로 이것마저도 자동화 가능해졌다.

### 클라우드의 대표적인 컴포넌트
#### 테넌트(tenant)
```
클라우드 환경에서 개인이 이용 가능한 부분으로, AWS의 경우 '계정'이 이에 해당한다.
테넌트별로 리소스의 사용량이 합산되어 사용료가 청구된다.
테넌트별로 리소스의 사용 가능한 상한선이 정해진다.
같은 테넌트에 속한 가상 네트워크, 가상 머신, 인스턴스, 가상 스토리지들끼리만 서로 연결된다.
일반적으로, 프로젝트 한 팀이 하나의 테넌트를 만들고 그 안에 프로젝트 팀이 개발하고 관리하는 애플리케이션 시스템을 모아 같은 테넌트에 넣는 형태로 구성한다.
```
#### 리전(region)
```
지리적으로 멀리 떨어진 지역에 여러 개의 클라우드 인프라를 분산 운영하는 AWS에서 특정 지역을 의미하는 용어
주로 인프라가 위치한 국가나 도시명으로 지어지는데, 한국 사용자가 많은 경우 서울 리전에 구축하는 게 유리하다.
각 리전은 독립된 환경이기 때문에 리전별로 가상 네트워크를 구성할 수 있지만, 여러 리전에 걸친 가상 네트워크는 만들지 못한다.
같은 테넌트에서 여러 리전을 구성하는 것은 가능하다.
DR을 구축할 때 리전1에서 문제가 발생할 경우 리전2로 전환할 수 있다. 단, 리전마다 사용 가능한 공인IP 범위가 다르기 때문에 이 경우에 APP사용자가 변경된 IP를 호출하거나 DNS가 변경된 IP를 반환하도록 도메인 등록 정보를 갱신해야 함을 유의하자.
오브젝트 스토리지(S3)는 모든 리전에서 공통으로 사용할 수 있다.
```
#### 가용영역(AZ, availability zone)
```
리전별로 가지는 데이터 센터의 범위
리전에는 여러 개의 가용영역이 있어서 가상 머신 인스턴스(EC2 등)나 블록 스토리지 볼륨을 배치할 데이터 센터를 선택할 수 있다.
단, 같은 가용 영역에 있어야 연결이 가능한 점을 유의하자.
기존에 A영역에서 사용 중인 블록 스토리지를 B영역에서 사용하고 싶을때, 블록 스토리지 복제기능으로 B영역에 동일한 블록 스토리지를 만들어 쓸 수 있다.
```
#### 라우터
```
가정용 인터넷을 연결할 때 인터넷 서비스 업체에서 대여해주는 가정용 인터넷 라우터가 필요하듯, 클라우드 환경에서도 테넌트 안의 가상 네트워크와 물리적인 외부 네트워크를 연결하기 위한 가상 라우터가 있어야 한다.
기본적으로 가상 네트워크 하나 당 하나의 가상 라우터가 배치된다.
가상 네트워크에서는 프라이빗IP주소(ex: 가정용 LAN) 혹은 사설IP주소를 사용한다.
외부 네트워크와 통신할 때는 가상 라우터의 NAT(Network Address Translation) 기능을 사용해서 퍼블릭IP 혹인 공인IP로 변환하게 된다.
통신 대상의 IP주소가 사설IP주소 범위에 있다면 다른 테넌트나 가상 네트워크에서 같은 IP를 사용하더라도 충돌은 발생하지 않는다.(가정용 LAN망에서 IP를 할당할 때 이웃집IP와 충돌날까 걱정하지 않는 이유와 같음)
```
#### 스위치(서브넷)
```
가상 스위치는 가상 라우터와 가상 머신 인스턴스의 가상 NIC(Network Interface Card)가 연결되는 접점이다.
하나의 스위치에 하나의 서브넷이 할당되는데, 서브넷은 가상 머신 인스턴스가 사용 가능한 사설IP 주소의 범위를 의미한다.
AWS는 스위치와 서브넷을 하나의 통합 형태로 취급한다.
하나의 가상 스위치는 하나의 가용 영역에 배치된다. (여러 가용영역에 걸쳐 사용될 수 없음)
가상 스위치를 정의한 후, 이를 가상 라우터에 연결하면 외부 네트워크와 통신 가능해진다.
또는 가상 스위치를 라우터에 연결하지 않고, 가상 네트워크 범위 안에서만 통신하도록 만들 수도 있다.
가상 스위치는 논리적으로 접속 포트 개수를 얼마든지 늘릴 수 있다. 가상 스위치를 정의하는 단계에서는 아직 접속 포트가 없는 상태이며, 가상 인스턴스와 연결하기 전에 비로소 접속 포트를 추가하고 그 포트에 가상 인스턴스의 가상 NIC를 연결하는 방식으로 가상 스위치가 구성된다.
```
#### 공인IP주소
```
가상 네트워크의 사설IP는 네트워크 내부에서는 사용 가능하나, 외부에서는 접속할 수 없다는 제약이 있다. 이때 가상 라우터의 NAT기능을 이용해 사설IP를 공인IP로 변환하여 사용한다.
이때 2가지 변환 방법이 있는데, 첫 번째는 'IP 마스커레이딩'이며 이는 가상 머신 인스턴스가 외부 네트워크로 접속할 때 가상 라우터가 할당 받은 공인IP를 공유하는 방식이다.
(가정용 LAN에 연결된 PC가 인터넷 라우터를 통해 인터넷에 접속하는 방식)
다만 이 경우에는 내부에서 외부로 나가는 접속은 가능하지만 외부에서 내부로 들어오는 접속은 허용되지 않는다.
그래서 두 번째 방법인 '엘라스틱 IP'를 사용한다. 이는 미리 개별적으로 확보해 둔 공인IP주소를 가상 머신 인스턴스에 할당하는 방식이다.
각 테넌트마다 엘라스틱IP로 사용할 수 있는 공인IP주소를 사전에 확보해두고, 그 중 하나를 특정 가상 머신 인스턴스에 할당한다.
이렇게하면 할당받은 엘라스틱IP로 내부->외부, 외부->내부 통신이 가능해진다.
단, 엘라스틱IP는 리전마다 따로 확보해야 해서 한 리전에서만 사용 가능하다.
```

### 인증과 보안
클라우드 환경에서 API나 각 리소스를 공유할 때 사용하는 HTTP, HTTPS 프로토콜에 대한 내용을 알아야 한다.
HTTP는 통신 내용이 평문으로 전달되기에 정보 유출의 위험이 있다. 중요 데이터가 오고 갈 때는 HTTPS를 사용하는 것이 일반적이다.
#### HTTPS
```
웹 사이트에서 로그인 등의 보안이 필요한 정보를 주고 받을 때 사용하는 기술로, 443포트를 사용한다.
TCP/IP OSI 참조 모델 L5의 SSL/TLS를 적용하고, 전자 인증서를 통해 통신 쌍방의 신뢰관계를 만드는 방식이다.
데이터의 암호화와 위변조 방지, 접속 URL이 신뢰할 수 있는 상대의 것인지를 확인하는 기능이 있다.
```
#### 인증서
```
클라우드가 신뢰할 수 있다는 것을 증명하기 위해 필요한 정보로, 서버와 클라이언트 인증서로 분류된다.
클라우드에서는 엔드포인트가 서버 측에 있으므로 서버 인증서가 활용된다. 
클라이언트가 누구이며 어디에 있는지의 정보는 클라우드가 제공하는 인증 기능을 사용하거나, HTTP 헤더의 유저 에이전트(user agent)정보를 통해 알아낸다.
통신 내용을 암복호화하기 위해 암복호화 키가 필요한데, 대표적으로 [공유 키 암호화 방식]과 [공개 키 암호화 방식]이 있다. HTTPS는 이 둘을 조합한 [하이브리드 암호화 방식]이다.
→ 공유 키를 공개 키 암호화 방식으로 안전하게 전달한 다음, 전달된 공유 키를 사용해서 암호화 통신을 함
클라우드의 엔드포인트에는 서버 인증서가 설정되어 있으므로, HTTPS로 API를 실행할 수 있다.
서버 인증서에는 인증서의 표준인 'Symantec'사의 인증서를 사용하는 것이 일반적이며, Symantec사의 인증기관인 CA(Certification Authority)가 해당 도메인에 대한 신뢰 여부를 인증한다.
이것은 서버의 URI가 신뢰할 수 있는지, HTTPS로 안전한 통신이 되는지를 인증하는 것이며 클라이언트의 안정성을 보장하지는 않는다.
클라이언트의 안정성을 보장하기 위해 ID와 PW로 로그인하는 등 다양한 방식이 있다.
이렇게 엔드포인트에 HTTPS가 적용되고 사용자 인증까지 더해지면 '서명'프로세스가 가능해진다.
```

### Reference
히라야마 쯔요시, '그림으로 배우는 클라우드 인프라의 API의 구조'
